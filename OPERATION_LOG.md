# AION2 Dashboard - 操作日志

## 2026-02-09

### 今日完成
- 完成 Electron + React + Vite + TypeScript 基础框架搭建，形成可持续迭代结构。
- 实现本地持久化（`electron-store`）与 `main/preload/renderer/shared` 分层。
- 建立配置驱动任务模型（`TaskDefinition`），支持后续按配置扩展任务。
- 实现奥德能量双池模型：
  - 自然能量：`xx/840`（每 3 小时 +15，自然恢复）
  - 补充能量：`(+yyyy)`（当前上限已改为 `+2000`）
  - 扣减顺序：先扣基础，再扣补充
- 实现关键自动刷新规则：
  - 每日 05:00 刷新
  - 每周三 05:00 刷新
  - 远征次数时段补充（04:00 / 12:00 / 20:00）
  - 超越次数时段补充（03:00 / 15:00）
  - 恶梦每日 +2（上限 14）
- 完成打卡交互重构（移除 prompt 的不稳定方案）：
  - 任务完成次数（支持输入）
  - 吃券 +1
  - 录入已完成（用于指令书类）
  - 失败时弹窗内显示明确错误原因（例如奥德不足、次数不足）
- 角色管理功能：
  - 新增角色
  - 重命名角色
  - 删除角色（至少保留 1 个）
- 圣域逻辑重构：
  - 合并为单卡“圣域”
  - 分开管理：挑战次数（4）/ 开箱次数（2，40奥德）
  - 支持手动设定
- 远征/超越手动设定：
  - 基础次数
  - 券次数
  - 首领次数
  - 增加输入说明，避免误解字段含义
- 恶梦/觉醒/讨伐也已支持手动设定（基础次数 + 券次数）。
- 远征 84 次策略改为“警示”而非“硬拦截”：
  - 超过 84 后继续允许挑战
  - 提示奖励/金币会折扣

### 当前业务规则状态
- 远征/超越完成次数：逻辑正常，支持多次输入、能量校验、券扣减。
- 远征/超越扣减顺序：基础次数优先扣减，再扣券次数。
- 奥德不足时会给出明确错误提示（已验证）。

### 明日建议优先事项（Phase 3）
1. 增加“操作历史日志 + 撤销一步/多步”。
2. 增加“下一次恢复倒计时”模块（远征/超越/每日/每周重置）。
3. 增加“设置页”：
   - 金币收益参数
   - 次数上限参数（可选）
   - 提示阈值参数（如远征 84 门槛）
4. 增加“数据导出/导入”以便备份与迁移。

### 合作约定
- 后续每次迭代结束，同步更新本文件，确保连续协作不丢上下文。

